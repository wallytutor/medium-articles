<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="/medium-articles/libs/katex/katex.min.css">
     
  
  <link rel="stylesheet" href="/medium-articles/css/franklin.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic|Source+Code+Pro:400,700" type="text/css">
<link rel="stylesheet" href="/medium-articles/css/font-awesome.min.css">
<link rel="stylesheet" href="/medium-articles/css/celeste.min.css">
<link rel="stylesheet" href="/medium-articles/css/custom.css">

<link rel="icon" type="image/png" sizes="192x192" href="/medium-articles/assets/favicon.png">
<link rel="shortcut icon" href="/medium-articles/assets/favicon.ico">


   <title>Reator pistão - introdução</title>  
</head>
<body>
  <header>
<nav class="nav-main">
  <ul>
    <li class="logo"><a class="hvr-ripple-out" href="/medium-articles/">W</a></li>
    <li class="hvr-underline-reveal"><a href="/medium-articles/content/medium/">Medium Articles</a></li>
    <li class="hvr-underline-reveal"><a href="/medium-articles/content/transport-phenomena/">Transport Phenomena</a></li>
    <li class="hvr-underline-reveal"><a href="/medium-articles/content/julia-para-cientistas/">Julia para Cientistas</a></li>
    <li class="hvr-underline-reveal"><a href="/medium-articles/content/engenharia-de-reatores/">Engenharia de Reatores</a></li>
  </ul>
</nav>
</header>


<!-- Content appended here -->
<div class="franklin-content">
<h1 id="reator_pistão_-_introdução"><a href="#reator_pistão_-_introdução" class="header-anchor">Reator pistão - introdução</a></h1>
<p>Este é o primeiro notebook de uma série abordando reatores do tipo <em>pistão</em> &#40;<em>plug-flow</em>&#41; no qual os efeitos advectivos são preponderantes sobre o comportamento difusivo, seja de calor, massa, ou espécies. O estudo e modelagem desse tipo de reator apresentar diversos interesses para a pesquisa fundamental e na indústria. Muitos reatores tubulares de síntese laboratorial de materiais apresentam aproximadamente um comportamento como tal e processos nas mais diversas indústrias podem ser aproximados por um ou uma rede de reatores pistão e reatores agitados interconectados.</p>
<p>Começaremos por um caso simples considerando um fluido incompressível e ao longo da série aumentaremos progressivamente a complexidade dos modelos. Os notebooks nessa série vão utilizar uma estratégia focada nos resultados, o que indica que o código será na maior parte do tempo ocultado e o estudante interessado deverá executar o notebook por si mesmo para estudar as implementações.</p>
<p>Nesta <em>Parte 1</em> vamos estuda a formulação na temperatura da equação de conservação de energia.</p>
<h2 id="modelo_da_temperatura"><a href="#modelo_da_temperatura" class="header-anchor">Modelo da temperatura</a></h2>
<p>No que se segue vamos implementar a forma mais simples de um reator pistão. Para este primeiro estudo o foco será dado apenas na solução da equação da energia. As etapas globais implementadas aqui seguem o livro de <a href="https://www.wiley.com/en-ie/Chemically&#43;Reacting&#43;Flow&#37;3A&#43;Theory&#37;2C&#43;Modeling&#37;2C&#43;and&#43;Simulation&#37;2C&#43;2nd&#43;Edition-p-9781119184874">Kee <em>et al.</em> &#40;2017&#41;</a>, seção 9.2.</p>
<p>Da forma simplificada como tratado, o problema oferece uma solução analítica análoga à <a href="https://pt.wikipedia.org/wiki/Lei_do_resfriamento_de_Newton">lei do resfriamento de Newton</a>, o que é útil para a verificação do problema. Os cálculos do número de Nusselt para avaliação do coeficiente de transferência de calor são providos nos anexos com expressões discutidas <a href="https://en.wikipedia.org/wiki/Nusselt_number">aqui</a>.</p>
<p>A primeira etapa no estabelecimento do modelo concerne as equações de conservação necessárias. No presente caso, com a ausência de reações químicas e trocas de matéria com o ambiente - o reator é um tubo fechado - precisamos estabelecer a conservação de massa e energia apenas. Como dito, o reator em questão conserva a massa transportada, o que é matematicamente expresso pela ausência de variação axial do fluxo de matéria, ou seja</p>
\[
\frac{d(\rho{}u)}{dz}=0
\]
<p>Mesmo que trivial, esse resultado é frequentemente útil na simplificação das outras equações de conservação para um reator pistão, como veremos &#40;com frequência&#41; mais tarde.</p>
<p>Embora não trocando matéria com o ambiente a través das paredes, vamos considerar aqui trocas térmicas. Afinal não parece muito útil um modelo de reator sem trocas de nenhum tipo nem reações. Da primeira lei da Termodinâmica temos que a taxa de variação da energia interna \(E\) é igual a soma das taxas de trocas de energia \(Q\) e do trabalho realizado \(W\).</p>
\[
\frac{dE}{dt}=
\frac{dQ}{dt}+
\frac{dW}{dt}
\]
<p>Podemos reescrever essa equação para uma seção transversal do reator de área \(A_{c}\) em termos das grandezas específicas e densidade \(\rho\) com as integrais</p>
\[
\int_{\Omega}\rho{}e\mathbf{V}\cdotp\mathbf{n}dA_{c}=
\dot{Q}-
\int_{\Omega}p\mathbf{V}\cdotp\mathbf{n}dA_{c}
\]
<p>Com a definição de entalpia \(h\) podemos simplificar essa equação e obter</p>
\[
\int_{\Omega}\rho{}h\mathbf{V}\cdotp\mathbf{n}dA_{c}=
\dot{Q}\qquad{}\text{aonde}\qquad{}h = e+\frac{p}{\rho}
\]
<p>Usando o teorema de Gauss transformamos essa integral sobre a superfície num integral de divergência sobre o volume diferencial \(dV\), o que é útil na manipulação de equações de conservação</p>
\[
\int_{\Omega}\rho{}h\mathbf{V}\cdotp\mathbf{n}dA_{c}=
\int_{V}\nabla\cdotp(\rho{}h\mathbf{V})dV
\]
<p>Nos resta ainda determinar \(\dot{Q}\). O tipo de interação com ambiente, numa escala macroscópica, não pode ser representado por leis físicas fundamentais. Para essa representação necessitamos de uma <em>lei constitutiva</em> que modela o fenômeno em questão. Para fluxos térmicos convectivos à partir de uma parede com temperatura fixa \(T_{s}\) a forma análoga a uma condição limite de Robin expressa o \(\dot{Q}\) como</p>
\[
\dot{Q}=\hat{h}A_{s}(T_{s}-T)=\hat{h}(Pdz)(T_{s}-T)
\]
<p>O coeficiente de troca térmica convectiva \(\hat{h}\) é frequentemente determinado à partir do tipo de escoamento usando fórmulas empíricas sobre o número de Nusselt. A abordagem desse tópico vai além do nosso escopo e assume-se que seu valor seja conhecido. Nessa expressão já transformamos a área superficial do reator \(A_{s}=Pdz\) o que nos permite agrupar os resultados em</p>
\[
\int_{V}\nabla\cdotp(\rho{}h\mathbf{V})dV=
\hat{h}(Pdz)(T_{w}-T)
\]
<p>Em uma dimensão \(z\) o divergente é simplemente a derivada nessa coordenada. Usando a relação diverencial \(\delta{}V=A_{c}dz\) podemos simplificar a equação para a forma diferencial como se segue</p>
\[
\frac{d(\rho{}u{}h)}{dz}=
\frac{\hat{h}Pdz}{\delta{}V}(T_{w}-T)
\implies
\frac{d(\rho{}u{}h)}{dz}=
\frac{\hat{h}P}{A_{c}}(T_{w}-T)
\]
<p>A expressão acima já consitui um modelo para o reator pistão, mas sua forma não é facilmente tratável analiticamente. Empregando a propriedade multiplicativa da diferenciaÇão podemos expandir o lado esquedo da equação como</p>
\[
\rho{}u{}\frac{dh}{dz}+h\frac{d(\rho{}u)}{dz}=
\frac{\hat{h}P}{A_{c}}(T_{w}-T)
\]
<p>O segundo termo acima é nulo em razão da conservação da matéria, como discutimos anteriormente. Da definição diferencial de entalpia \(dh=c_{p}dT\) chegamos a formulação do modelo na temperatura como dado no título dessa seção.</p>
\[
\rho{}u{}c_{p}A_{c}\frac{dT}{dz}=
\hat{h}P(T_{w}-T)
\]
<p>Vamos agora empregar esse modelo para o cálculo da distribuição axial de temperatura ao longo do reator. No que se segue assume-se um reator tubular de seção circular de raio \(R\) e todos os parâmetros do modelo são constantes.</p>
<h3 id="solução_analítica_da_edo"><a href="#solução_analítica_da_edo" class="header-anchor">Solução analítica da EDO</a></h3>
<p>O problema tratado aqui permite uma solução analítica simples que desenvolvemos de maneira um pouco abrupta no que se segue. Separando os termos em \(T\) &#40;variável dependente&#41; e \(z\) &#40;variável independente&#41; e integrando sobre os limites adequados obtemos</p>
\[
\int_{T_{0}}^{T}\frac{dT}{T_{w}-T}=
\frac{\hat{h}P}{\rho{}u{}c_{p}A_{c}}\int_{0}^{z}dz=
\mathcal{C}_{0}z
\]
<p>Na expressão acima \(\mathcal{C}_{0}\) não é uma constante de integração mas apenas regrupa os parâmetros do modelo. O termo em \(T\) pode ser integrado por uma substituição trivial</p>
\[
u=T_{w}-T \implies -\int\frac{du}{u}=\log(u)\biggr\vert_{u_0}^{u}+\mathcal{C}_{1}
\]
<p>Realizando a integração definida e resolvendo para \(T\) chegamos a</p>
\[
T=T_{w}-(T_{w}-T_{0})\exp\left(-\mathcal{C}_{0}z+\mathcal{C}_{1}\right)
\]
<p>É trivial verificar com \(T(z=0)=T_{0}\) que \(\mathcal{C}_{1}=0\) o que conduz à solução analítica que é implementada no que se segue em <code>analyticalthermalpfr</code>.</p>
\[
T=T_{w}-(T_{w}-T_{0})\exp\left(-\frac{\hat{h}P}{\rho{}u{}c_{p}A_{c}}z\right)
\]
<p>O bloco abaixo resolve o problema para um conjunto de condições que você pode consultar nos anexos e expandindo o seu código. Observe abaixo da célula um <em>log</em> do cálculo dos números adimensionais relevantes ao problema e do coeficiente de transferência de calor convectivo associado. Esses elementos são tratados por funções externas que se encontram em um arquivo de suporte a esta série e são tidos como conhecimentos <em>a priori</em> para as discussões.</p>
<h3 id="integração_numérica_da_edo"><a href="#integração_numérica_da_edo" class="header-anchor">Integração numérica da EDO</a></h3>
<p>Neste exemplo tivemos <em>sorte</em> de dispor de uma solução analítica. Esse problema pode facilmente tornar-se intratável se considerarmos uma dependência arbitrária do calor específico com a temperatura ou se a parede do reator tem uma dependência na coordenada axial. É importante dispor de meios numéricos para o tratamento deste tipo de problema.</p>
<p>No caso de uma equação diferencial ordinária &#40;EDO&#41; como no presente caso, a abordagem mais simples é a de se empregar um integrador numérico. Para tanto é prática comum estabelecer uma função que representa o <em>lado direito</em> do problema isolando a&#40;s&#41; derivada&#40;s&#41; no lado esquerdo. Em Julia dispomos do <em>framework</em> de <code>ModelingToolkit</code> que provê uma forma simbólica de representação de problemas e interfaces com diversos integradores. A estrutura <code>DifferentialEquationPFR</code> abaixo implementa o problema diferencial desta forma.</p>
<p>Para integração do modelo simbólico necessitamos substituir os parâmetros por valores numéricos e fornecer a condição inicial e intervalo de integração ao integrador que vai gerir o problema. A interface <code>solveodepfr</code> realiza essas etapas. É importante mencionar aqui que a maioria dos integradores numéricos vai <em>amostrar</em> pontos na coordenada de integração segundo a <em>rigidez numérica</em> do problema, de maneira que a solução retornada normalmente não está sobre pontos equi-espaçados. Podemos fornecer um parâmetro opcional para recuperar a solução sobre os pontos desejados, o que pode facilitar, por exemplo, comparação com dados experimentais.</p>
<p>Uma funcionalidade bastante interessante de <code>ModelingToolkit</code> é sua capacidade de representar diretamente em com \(\LaTeX\) as equações implementadas. Antes de proceder a solução verificamos na célula abaixo que a equação estabelecida no modelo está de acordo com a formulação que derivamos para o problema diferencial. Verifica-se que a ordem dos parâmetros pode não ser a mesma, mas o modelo é equivalente.</p>
<p>Com isso podemos proceder à integração com ajuda de <code>solveodepfr</code> concebida acima e aproveitamos para traçar o resultado em conjunto com a solução analítica.</p>
<h3 id="método_dos_volumes_finitos"><a href="#método_dos_volumes_finitos" class="header-anchor">Método dos volumes finitos</a></h3>
<p>Quando integrando apenas um reator, o método de integração numérica da equação é geralmente a escolha mais simples. No entanto, em situações nas quais desejamos integrar trocas entre diferentes reatores aquela abordagem pode se tornar proibitiva. Uma dificuldade que aparece é a necessidade de solução iterativa até convergência dados os fluxos pelas paredes do reator, o que demandaria um código extremamente complexo para se gerir em integração direta. Outro caso são trocadores de calor que podem ser representados por conjutos de reatores em contra-corrente, um exemplo que vamos tratar mais tarde nesta série. Nestes casos podemos ganhar em simplicidade e tempo de cálculo empregando métodos que <em>linearizam</em> o problema para então resolvê-lo por uma simples <em>álgebra linear</em>.</p>
<p>Na temática de fênomenos de transporte, o método provavelmente mais frequentemente utilizado é o dos volumes finitos &#40;em inglês abreviado FVM&#41;. Note que em uma dimensão com coeficientes constantes pode-se mostrar que o método é equivalente à diferenças finitas &#40;FDM&#41;, o que é nosso caso neste problema. No entanto vamos insistir na tipologia empregada com FVM para manter a consistência textual nos casos em que o problema não pode ser reduzido à um simples FDM.</p>
<p>No que se segue vamos usar uma malha igualmente espaçada de maneira que nossas coordenadas de solução estão em \(z\in\{0,\delta,2\delta,\dots,N\delta\}\) e as interfaces das células encontram-se nos pontos intermediários. Isso dito, a primeira e última célula do sistema são <em>meias células</em>, o que chamaremos de <em>condição limite imersa</em>, contrariamente à uma condição ao limite com uma célula fantasma na qual o primeiro ponto da solução estaria em \(z=\delta/2\). Trataremos esse caso em outra ocasião.</p>
<p>O problema de transporte advectivo em um reator pistão é essencialmente <em>upwind</em>, o que indica que a solução em uma célula \(E\)<em>a leste</em> de uma célula \(P\) depende exclusivamente da solução em \(P\). Veremos o impacto disto na forma matricial trivial que obteremos na sequência. Para a sua construção, começamos pela integração do problema entre \(P\) e \(E\), da qual se segue a separação de variáveis</p>
\[
\int_{T_P}^{T_E}\rho{}u{}c_{p}A_{c}dT=
\int_{0}^{\delta}\hat{h}{P}(T_{s}-T^{\star})dz
\]
<p>Observe que introduzimos a variável \(T^{\star}\) no lado direito da equação e não sob a integral em \(dT\). Essa escolha se fez porque ainda não precisamos definir qual a temperatura mais representativa deve-se usar para o cálculo do fluxo térmico. Logo vamos interpretá-la como uma constante que pode ser movida para fora da integral</p>
\[
\rho{}u{}c_{p}A_{c}\int_{T_P}^{T_E}dT=
\hat{h}{P}(T_{s}-T^{\star})\int_{0}^{\delta}dz
\]
<p>Realizando-se a integração definida obtemos a forma paramétrica</p>
\[
\rho{}u{}c_{p}A_{c}(T_{E}-T_{P})=
\hat{h}{P}\delta(T_{s}-T^{\star})
\]
<p>Para o tratamento com FVM agrupamos parâmetros para a construção matricial, o que conduz à</p>
\[
aT_{E}-aT_{P}=
T_{s}-T^{\star}
\]
<p>No método dos volumes finitos consideramos que a solução é constante através de uma célula. Essa hipótese é a base para construção de um modelo para o parâmetro \(T^{\star}\) na presente EDO. Isso não deve ser confundido com os esquemas de interpolaçãO que encontramos em equações diferenciais parciais.</p>
<p>A ideia é simples: tomemos um par de células \(P\) e \(E\) com suas respectivas temperaturas \(T_{P}\) e \(T_{E}\). O limite dessas duas células encontra-se no ponto médio entre seus centros, que estão distantes de um comprimento \(\delta\). Como a solução é constante em cada célula, entre \(P\) e a parede o fluxo de calor total entre seu centro e a fronteira \(e\) com a célula \(E\) é</p>
\[
\dot{Q}_{P-e} = \hat{h}{P}(T_{s}-T_{P})\delta_{P-e}=\frac{\hat{h}{P}\delta}{2}(T_{s} - T_{P})
\]
<p>De maneira análoga, o fluxo entre a fronteira \(e\) e o centro de \(E\) temos</p>
\[
\dot{Q}_{e-E} = \hat{h}{P}(T_{s}-T_{E})\delta_{e-E}=\frac{\hat{h}{P}\delta}{2}(T_{s}-T_{E})
\]
<p>Nas expressões acima usamos a notação em letras minúsculas para indicar fronteiras entre células. A célula de <em>referência</em> é normalmente designada \(P\), e logo chamamos a fronteira pela letra correspondendo a célula vizinha em questão, aqui \(E\). O fluxo convectivo total entre \(P\) e \(E\) é portanto</p>
\[
\dot{Q}_{P-E}=\dot{Q}_{P-e}+\dot{Q}_{e-E}=\hat{h}{P}\left[T_{s}-\frac{(T_{E}+T_{P})}{2}\right]
\]
<p>de onde adotamos o modelo</p>
\[
T^{\star}=\frac{T_{E}+T_{P}}{2}
\]
<p>A troca convectiva com a parede não seria corretamente representada se escolhessemos \(T_{P}\) como referência para o cálculo do fluxo &#40;o que seria o caso em FDM&#41;. Obviamente aproximações de ordem superior são possíveíveis empregando-se mais de duas células mas isso ultrapassa o nível de complexidade que almejamos entrar no momento.</p>
<p>Aplicando-se esta expressão na forma numérica precedente, após manipulação chega-se à</p>
\[
(2a + 1)T_{E}=
(2a - 1)T_{P} + 2T_{w}
\]
<p>Com algumas manipulações adicionais obtemos a forma que será usada na sequência</p>
\[
-A^{-}T_{P} + A^{+}T_{E}=1\quad\text{aonde}\quad{}A^{\pm} = \frac{2a \pm 1}{2T_{w}}
\]
<p>A expressão acima é válida entre todos os pares de células \(P\rightarrow{}E\) no sistema, exceto pela primeira. Como se trata de uma EDO, a primeira célula do sistema contém a condição inicial \(T_{0}\) e não é precedida por nenhuma outra célula e evidentemente não precisamos resolver uma equação adicional para esta. Considerando o par de vizinhos \(P\rightarrow{}E\equiv{}0\rightarrow{}1\), substituindo o valor da condição inicial obtemos a modificação da equação para a condição inicial imersa</p>
\[
A^{+}T_{1}=1 + A^{-}T_{0}
\]
<p>Como não se trata de um problema de condições de contorno, nada é necessário para a última célula do sistema. Podemos agora escrever a forma matricial do problema que se dá por</p>
\[
\begin{bmatrix}
 A^{+}  &  0     &  0     & \dots  &  0      &  0      \\
-A^{-}  &  A^{+} &  0     & \dots  &  0      &  0      \\
 0      & -A^{-} &  A^{+} & \ddots &  0      &  0      \\
\vdots  & \ddots & \ddots & \ddots & \ddots  & \vdots  \\
 0      &  0     &  0     & -A^{-} &  A^{+}  &   0     \\
 0      &  0     &  0     &  0     & -A^{-}  &   A^{+} \\
\end{bmatrix}
\begin{bmatrix}
T_{1}    \\
T_{2}    \\
T_{3}    \\
\vdots   \\
T_{N-1}  \\
T_{N}    \\
\end{bmatrix}
=
\begin{bmatrix}
1 + A^{-}T_{0}  \\
1               \\
1               \\
\vdots          \\
1               \\
1               \\
\end{bmatrix}
\]
<p>A dependência de \(E\) somente em \(P\) faz com que tenhamos uma matriz diagonal inferior, aonde os \(-A^{-}\) são os coeficientes de \(T_{P}\) na formulação algébrica anterior. A condição inicial modifica o primeiro elemento do vetor constante à direita da igualdade. A construção e solução deste problema é provida em <code>solvethermalpfr</code> abaixo.</p>
<p>Abaixo adicionamos a solução do problema sobre malhas grosseiras sobre as soluções desenvolvidas anteriormente. A ideia de se representar sobre malhas grosseiras é simplesmente ilustrar o caráter discreto da solução, que é representada como constante no interior de uma célula. Adicionalmente representamos no gráfico um resultado interpolado de uma simulação CFD 3-D de um reator tubular em condições <em>supostamente identicas</em> as representadas aqui, o que mostra o bom acordo de simulações 1-D no limite de validade do modelo.</p>
<p>Com isso encerramos essa primeira introdução a modelagem de reatores do tipo pistão. Estamos ainda longe de um modelo generalizado para estudo de casos de produção, mas os principais blocos de construção foram apresentados. Os pontos principais a reter deste estudo são:</p>
<ul>
<li><p>A equação de conservação de massa é o ponto chave para a expansão e simplificação das demais equações de conservação. Note que isso é uma consequência de qua a massa corresponde à aplicação do <a href="https://pt.wikipedia.org/wiki/Teorema_de_transporte_de_Reynolds">Teorema de Transporte de Reynolds</a> sobre a <em>unidade 1</em>. </p>
</li>
</ul>
<ul>
<li><p>Sempre que a implementação permita, é mais fácil de se tratar o problema como uma EDO e pacotes como ModelingToolkit proveem o ferramental básico para a construção deste tipo de modelos facilmente.</p>
</li>
</ul>
<ul>
<li><p>Uma implementação em volumes finitos será desejável quando um acoplamento com outros modelos seja envisajada. Neste caso a gestão da solução com uma EDO a parâmetros variáveis pode se tornar computacionalmente proibitiva, seja em complexidade de código ou tempo de cálculo.</p>
</li>
</ul>
<div class="page-foot">
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Walter Dal'Maz Silva -
    Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
</div>
</div><!-- CONTENT ENDS HERE -->
    
        <script src="/medium-articles/libs/katex/katex.min.js"></script>
<script src="/medium-articles/libs/katex/contrib/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

    
    
  </body>
</html>
